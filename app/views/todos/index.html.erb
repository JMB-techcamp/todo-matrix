<header>
  <h1>TODOリスト</h1>
  <a href="/user/<%= current_user.id %>/mypage">OK</a>
</header><!-- /header -->

<!--
<%  @todos.each do |todos| %>
  <li>
      <a href=<%="/todos/#{todos.id}"%> > <%= todos.title %> </a>
  </li>
<% end %> -->

<table>
  <thead>
    <tr>
      <th></th>
      <th>タスク</th>
      <th>期限</th>
    </tr>
  </thead>
  <tbody id="sortable">
    <% i = 0 %>
    <%  @todos.each do |todo| %>
      <% i += 1 %>
      <tr id="row_<%= todo.id %>">
        <td><%= i %></td>
        <td><%= todo.title %></td>
        <td><%= todo.dead_line %></td>
      </tr>
    <% end %>
  </tbody>
</table>


<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.js'></script>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.0/jquery-ui.css' />
<script src='https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js'></script>

<script type="text/javascript">
$(function() {
  $("#sortable").sortable({
     cursor: 'move',
     start: function(event, ui) {ui.item.css("background-color", "orange");},
     stop: function(event, ui) {
       ui.item.css("background-color", "white");
       jQuery.post('<%=reorder_todos_path%>', $(this).sortable('serialize'), null, 'text');
     }
  });
  $("#sortable").disableSelection();
});
</script>
